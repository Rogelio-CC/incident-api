name: Docker build & Publish
on: 
  push: 
      branches:
        - main

jobs:
    build-and-push:
      runs-on: ubuntu-latest
      steps: 
          - name: Clone code
            uses: actions/checkout@v2
          
          - name: Login to Docker hub
            run: docker login -u "${{ secrets.DOCKER_USERNAME }}" -p "${{ secrets.DOCKER_PASSWORD }}"

          - name: Build Docker Image
            run: docker build -t rogercc28/incident-api:${{ github.sha }} .
          
          - name: Push Docker Image
            run: docker push rogercc28/incident-api:${{ github.sha }} 
